Model:
    bricks*=Brick
    states*=State
;

Brick:
    Actuator | Sensor
;

Actuator:
    'ACTUATOR' name=ID pin=INT
;

Sensor:
    'SENSOR' name=ID pin=INT
;

DigitalValue:
    value='ON' | value='OFF'
;

Action:
    'SET' var=ID value=DigitalValue
;

Transition:
    cond=Condition '->' next_state=ID
;

State:
    is_init_state?='INIT' name=ID '{'
    exprs*=Exprs
    '}'
;

Exprs:
    Action | Transition
;

Condition:

    l=Bexpr op=Bop r=Condition |
    l=Bexpr op=Bop r=Bexpr |
    single=Bexpr
;

Bop:
    token='AND' | token='OR'
;

Bexpr:
    var=ID op='==' value=DigitalValue
;